\begin{code}%
\>\AgdaKeyword{module} \AgdaModule{Term} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{NaturalProp}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{ListProperties}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Chi}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat} \AgdaSymbol{as} \AgdaModule{Nat} \AgdaKeyword{hiding} \AgdaSymbol{(}\_*\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat.Properties}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Bool} \AgdaKeyword{hiding} \AgdaSymbol{(}\_≟\_\AgdaSymbol{;}\_∨\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Empty}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Function}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Function.Inverse} \AgdaKeyword{hiding} \AgdaSymbol{(}sym\AgdaSymbol{;}\_∘\_\AgdaSymbol{;}map\AgdaSymbol{;}id\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Inverse}\<%
\\
\>\AgdaKeyword{import} \AgdaModule{Function.Equality} \AgdaSymbol{as} \AgdaModule{FE}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Sum} \AgdaKeyword{hiding} \AgdaSymbol{(}map\AgdaSymbol{)} \AgdaKeyword{renaming} \AgdaSymbol{(}\_⊎\_ \AgdaSymbol{to} \_∨\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Product} \AgdaKeyword{renaming} \AgdaSymbol{(}Σ \AgdaSymbol{to} Σₓ\AgdaSymbol{;}map \AgdaSymbol{to} mapₓ\AgdaSymbol{;}\_,\_ \AgdaSymbol{to} \_∶\_\AgdaSymbol{)} \AgdaKeyword{public}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Nullary} \<[29]%
\>[29]\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Nullary.Decidable} \AgdaKeyword{hiding} \AgdaSymbol{(}map\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary} \AgdaKeyword{hiding} \AgdaSymbol{(}Rel\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality} \AgdaSymbol{as} \AgdaModule{PropEq} \AgdaKeyword{renaming} \AgdaSymbol{(}[\_] \AgdaSymbol{to} [\_]ᵢ\AgdaSymbol{)} \<[83]%
\>[83]\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List} \AgdaKeyword{hiding} \AgdaSymbol{(}any\AgdaSymbol{)} \AgdaKeyword{renaming} \AgdaSymbol{(}length \AgdaSymbol{to} length'\AgdaSymbol{)} \<[64]%
\>[64]\<%
\\
\>\AgdaComment{-- open import Data.List.Any as Any hiding (map)}\<%
\\
\>\AgdaComment{-- open import Data.List.Any.Membership}\<%
\\
\>\AgdaComment{-- open Any.Membership-≡ }\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Algebra.Structures}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{DecTotalOrder} \AgdaFunction{Nat.decTotalOrder} \AgdaKeyword{using} \AgdaSymbol{()} \AgdaKeyword{renaming} \AgdaSymbol{(}refl \AgdaSymbol{to} ≤-refl\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{≤-Reasoning}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{renaming} \AgdaSymbol{(}begin\_ \AgdaSymbol{to} start\_\AgdaSymbol{;} \_∎ \AgdaSymbol{to} \_◽\AgdaSymbol{;} \_≡⟨\_⟩\_ \AgdaSymbol{to} \_≤⟨\_⟩'\_\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{infix} \AgdaNumber{6} \_·\_ \<%
\\
\>\AgdaKeyword{infix} \AgdaNumber{1} \_⊢\_∶\_ \<%
\\
\>\AgdaKeyword{infix} \AgdaNumber{3} \_\#\_ \<%
\\
\>\AgdaKeyword{infix} \AgdaNumber{1} \_*\_ \<%
\\
\>\<%
\end{code}

\end{code}

%<*term>
\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{Λ} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{v} \<[7]%
\>[7]\AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaDatatype{Λ} \<[15]%
\>[15]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\_·\_} \<[7]%
\>[7]\AgdaSymbol{:} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaDatatype{Λ} \<[19]%
\>[19]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ƛ} \<[7]%
\>[7]\AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaDatatype{Λ} \<%
\end{code}
%</term>

\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{Type} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{τ} \<[7]%
\>[7]\AgdaSymbol{:} \AgdaDatatype{Type}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\_⟶\_} \<[7]%
\>[7]\AgdaSymbol{:} \AgdaDatatype{Type} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaSymbol{→} \AgdaDatatype{Type}\<%
\\
\>\AgdaKeyword{import} \AgdaModule{Context}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{module} \AgdaModule{M} \AgdaSymbol{=} \AgdaModule{Context} \AgdaSymbol{(}\AgdaDatatype{Type}\AgdaSymbol{)(}\AgdaFunction{\_≟\_}\AgdaSymbol{)} \AgdaKeyword{public}\<%
\end{code}

%<*type>
\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{\_⊢\_∶\_} \AgdaSymbol{(}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{):} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaDatatype{Type} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⊢v} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \<[35]%
\>[35]\AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{p∈} \AgdaSymbol{:} \AgdaBound{x} \AgdaFunction{∈} \AgdaBound{Γ}\AgdaSymbol{)} \<[65]%
\>[65]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaInductiveConstructor{v} \AgdaBound{x} \AgdaDatatype{∶} \AgdaBound{Γ} \AgdaFunction{⟨} \AgdaBound{p∈} \AgdaFunction{⟩}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⊢·} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{α} \AgdaBound{β} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[35]%
\>[35]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaInductiveConstructor{⟶} \AgdaBound{β} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{α} \<[64]%
\>[64]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{β}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaBound{β} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[35]%
\>[35]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaFunction{‚} \AgdaBound{x} \AgdaInductiveConstructor{∶} \AgdaBound{α} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{β} \<[65]%
\>[65]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaInductiveConstructor{⟶} \AgdaBound{β}\<%
\end{code}
%</type>

Some type results:
%<*weakening>
\begin{code}%
\>\AgdaFunction{lemmaWeakening⊢} \AgdaSymbol{:} \<[19]%
\>[19]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaBound{Δ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}}\<%
\\
\>[2]\AgdaIndent{16}{}\<[16]%
\>[16]\AgdaSymbol{→} \<[19]%
\>[19]\AgdaBound{Γ} \AgdaFunction{⊆} \AgdaBound{Δ} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{Δ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α}\<%
\end{code}
%</weakening>

\begin{code}%
\>\AgdaFunction{lemmaWeakening⊢} \AgdaBound{Γ⊆Δ} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢v} \AgdaBound{x∈Γ}\AgdaSymbol{)} \AgdaKeyword{rewrite} \AgdaField{proj₂} \AgdaSymbol{(}\AgdaBound{Γ⊆Δ} \AgdaBound{x∈Γ}\AgdaSymbol{)} \<[53]%
\>[53]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢v} \AgdaSymbol{(}\AgdaField{proj₁} \AgdaSymbol{(}\AgdaBound{Γ⊆Δ} \AgdaBound{x∈Γ}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemmaWeakening⊢} \AgdaBound{Γ⊆Δ} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaBound{Γ⊢M:α⟶β} \AgdaBound{Γ⊢N:α}\AgdaSymbol{)} \<[39]%
\>[39]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢·} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaBound{Γ⊆Δ} \AgdaBound{Γ⊢M:α⟶β}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaBound{Γ⊆Δ} \AgdaBound{Γ⊢N:α}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaWeakening⊢} \AgdaBound{Γ⊆Δ} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,y:α⊢M:β}\AgdaSymbol{)} \<[35]%
\>[35]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaSymbol{(}\AgdaFunction{lemma⊆∷} \AgdaBound{Γ⊆Δ}\AgdaSymbol{)} \AgdaBound{Γ,y:α⊢M:β}\AgdaSymbol{)}\<%
\end{code}

-- %<*typein>
-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemmaWeakening⊢∈∷  :  \{x : V\}\{Γ : Cxt\}\{M : Λ\} }\<%
\\
\>\AgdaComment{--                    →  x ∈ Γ → Γ ‚ x ⊢ M → Γ ⊢ M}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}
-- %</typein>

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemmaWeakening⊢∈∷ \{x\} x∈Γ Γ,x⊢M = lemmaWeakening⊢ (lemmax∈Γ⇒Γ,x⊆Γ x∈Γ) Γ,x⊢M}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

\begin{code}%
\>\AgdaFunction{length} \AgdaSymbol{:} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaDatatype{ℕ}\<%
\\
\>\AgdaFunction{length} \AgdaSymbol{(}\AgdaInductiveConstructor{v} \AgdaSymbol{\_)} \<[15]%
\>[15]\AgdaSymbol{=} \AgdaNumber{1}\<%
\\
\>\AgdaFunction{length} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{length} \AgdaBound{M} \AgdaPrimitive{+} \AgdaFunction{length} \AgdaBound{N}\<%
\\
\>\AgdaFunction{length} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{length} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{length>0} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{length} \AgdaBound{M} \AgdaFunction{>} \AgdaInductiveConstructor{zero}\<%
\\
\>\AgdaFunction{length>0} \AgdaSymbol{\{}\AgdaInductiveConstructor{v} \AgdaBound{x}\AgdaSymbol{\}} \<[17]%
\>[17]\AgdaSymbol{=} \AgdaFunction{start}\<%
\\
\>[2]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\<%
\\
\>[2]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaFunction{≤⟨} \AgdaFunction{≤-refl} \AgdaFunction{⟩}\<%
\\
\>[2]\AgdaIndent{20}{}\<[20]%
\>[20]\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\<%
\\
\>[0]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{◽}\<%
\\
\>\AgdaFunction{length>0} \AgdaSymbol{\{}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{start}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{≤⟨} \AgdaFunction{length>0} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaFunction{⟩}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{length} \AgdaBound{M}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{≤⟨} \AgdaFunction{m≤m+n} \AgdaSymbol{(}\AgdaFunction{length} \AgdaBound{M}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{length} \AgdaBound{N}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{length} \AgdaBound{M} \AgdaPrimitive{+} \AgdaFunction{length} \AgdaBound{N}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{≤⟨} \AgdaFunction{≤-refl} \AgdaFunction{⟩}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{length} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaFunction{◽}\<%
\\
\>\AgdaFunction{length>0} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{start}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero} \<[31]%
\>[31]\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{≤⟨} \AgdaInductiveConstructor{s≤s} \AgdaInductiveConstructor{z≤n} \AgdaFunction{⟩}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaInductiveConstructor{suc} \AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{≤⟨} \AgdaInductiveConstructor{s≤s} \AgdaSymbol{(}\AgdaFunction{length>0} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\})} \AgdaFunction{⟩}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaInductiveConstructor{suc} \AgdaSymbol{(}\AgdaFunction{length} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{≤⟨} \AgdaFunction{≤-refl} \AgdaFunction{⟩}\<%
\\
\>[19]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaFunction{length} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{21}{}\<[21]%
\>[21]\AgdaFunction{◽}\<%
\end{code}

Fresh variable

\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{\_\#\_} \AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\#v} \<[6]%
\>[6]\AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \<[27]%
\>[27]\AgdaSymbol{→} \<[30]%
\>[30]\AgdaBound{y} \AgdaFunction{≢} \AgdaBound{x} \<[45]%
\>[45]\AgdaSymbol{→} \<[48]%
\>[48]\AgdaBound{x} \AgdaDatatype{\#} \AgdaInductiveConstructor{v} \AgdaBound{y}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\#·} \<[6]%
\>[6]\AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[27]%
\>[27]\AgdaSymbol{→} \<[30]%
\>[30]\AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{N} \<[45]%
\>[45]\AgdaSymbol{→} \<[48]%
\>[48]\AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\#ƛ≡} \AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[45]%
\>[45]\AgdaSymbol{→} \<[48]%
\>[48]\AgdaBound{x} \AgdaDatatype{\#} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{\#ƛ} \<[6]%
\>[6]\AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[27]%
\>[27]\AgdaSymbol{→} \<[30]%
\>[30]\AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \<[45]%
\>[45]\AgdaSymbol{→} \<[48]%
\>[48]\AgdaBound{x} \AgdaDatatype{\#} \AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\<%
\end{code}

-- %<*typefresh>
-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemma\#⊢  :  \{x : V\}\{Γ : Cxt\}\{M : Λ\} }\<%
\\
\>\AgdaComment{--          →  x \# M → Γ ‚ x ⊢ M → Γ ⊢ M}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}
-- %</typefresh>

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemma\#⊢ (\#v y≢x)     (⊢v (here y≡x)) }\<%
\\
\>\AgdaComment{--   = ⊥-elim (y≢x y≡x)}\<%
\\
\>\AgdaComment{-- lemma\#⊢ (\#v x₂)      (⊢v (there y∈Γ))}\<%
\\
\>\AgdaComment{--   = ⊢v y∈Γ}\<%
\\
\>\AgdaComment{-- lemma\#⊢ (\#· x\#M x\#N) (⊢· Γ,x⊢M Γ,x⊢N) }\<%
\\
\>\AgdaComment{--   = ⊢· (lemma\#⊢ x\#M Γ,x⊢M) (lemma\#⊢ x\#N Γ,x⊢N)}\<%
\\
\>\AgdaComment{-- lemma\#⊢ \#ƛ≡          (⊢ƛ Γ,x,x⊢M) }\<%
\\
\>\AgdaComment{--   = ⊢ƛ (lemmaWeakening⊢∈∷ (here refl) Γ,x,x⊢M)}\<%
\\
\>\AgdaComment{-- lemma\#⊢ (\#ƛ x\#M)     (⊢ƛ Γ,x,y⊢M) }\<%
\\
\>\AgdaComment{--   = ⊢ƛ (lemma\#⊢ x\#M (lemmaWeakening⊢ lemmaΓ,x,y⊆Γ,y,x Γ,x,y⊢M))}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

\begin{code}%
\>\AgdaFunction{\_∼\#\_} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaFunction{\_∼\#\_} \AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{=} \AgdaSymbol{(∀} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M'}\AgdaSymbol{)} \AgdaFunction{×} \AgdaSymbol{(∀} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M}\AgdaSymbol{)}\<%
\end{code}

Variable Ocurr free in a term.

\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{\_*\_} \AgdaSymbol{:} \AgdaFunction{V} \AgdaSymbol{→} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{*v} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \<[44]%
\>[44]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaInductiveConstructor{v} \AgdaBound{x}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{*·l} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \<[44]%
\>[44]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{*·r} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{N} \<[44]%
\>[44]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{*ƛ} \<[7]%
\>[7]\AgdaSymbol{:} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{y} \AgdaFunction{≢} \AgdaBound{x} \<[44]%
\>[44]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\<%
\end{code}

-- -- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- -- lemma*⊢ : \{M N : Λ\}\{x : V\} → x * M → Γ ⊢ M → x ∈ Γ}\<%
\\
\>\AgdaComment{-- -- }\<%
\end{code}

\begin{code}%
\>\AgdaFunction{\_\#?\_} \AgdaSymbol{:} \AgdaFunction{Decidable} \AgdaDatatype{\_\#\_}\<%
\\
\>\AgdaBound{x} \AgdaFunction{\#?} \AgdaSymbol{(}\AgdaInductiveConstructor{v} \AgdaBound{y}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟} \AgdaBound{x}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y≡x} \AgdaSymbol{=} \AgdaInductiveConstructor{no} \AgdaSymbol{(λ} \AgdaSymbol{\{(}\AgdaInductiveConstructor{\#v} \AgdaBound{y≢x}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{y≢x} \AgdaBound{y≡x}\AgdaSymbol{\})}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{y≢x} \AgdaSymbol{=} \AgdaInductiveConstructor{yes} \AgdaSymbol{(}\AgdaInductiveConstructor{\#v} \AgdaBound{y≢x}\AgdaSymbol{)}\<%
\\
\>\AgdaBound{x} \AgdaFunction{\#?} \AgdaSymbol{(}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{\#?} \AgdaBound{M} \AgdaSymbol{|} \AgdaBound{x} \AgdaFunction{\#?} \AgdaBound{N} \<[34]%
\>[34]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \<[21]%
\>[21]\AgdaBound{x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{yes} \AgdaSymbol{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaBound{x\#N}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[20]%
\>[20]\AgdaBound{¬x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{no} \AgdaSymbol{(λ} \AgdaSymbol{\{(}\AgdaInductiveConstructor{\#·} \AgdaSymbol{\_} \AgdaBound{x\#N}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{¬x\#N} \AgdaBound{x\#N}\AgdaSymbol{\})}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \<[21]%
\>[21]\AgdaBound{x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{no} \AgdaSymbol{(λ} \AgdaSymbol{\{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaSymbol{\_)} \<[47]%
\>[47]\AgdaSymbol{→} \AgdaBound{¬x\#M} \AgdaBound{x\#M}\AgdaSymbol{\})}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[20]%
\>[20]\AgdaBound{¬x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{no} \AgdaSymbol{(λ} \AgdaSymbol{\{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaSymbol{\_)} \<[47]%
\>[47]\AgdaSymbol{→} \AgdaBound{¬x\#M} \AgdaBound{x\#M}\AgdaSymbol{\})}\<%
\\
\>\AgdaBound{x} \AgdaFunction{\#?} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{)} \AgdaKeyword{with} \AgdaBound{y} \AgdaSymbol{|} \AgdaBound{x} \AgdaFunction{≟} \AgdaBound{y} \<[28]%
\>[28]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaSymbol{.}\AgdaBound{x} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaInductiveConstructor{refl} \AgdaSymbol{=} \AgdaInductiveConstructor{yes} \AgdaInductiveConstructor{\#ƛ≡}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaSymbol{\_} \<[9]%
\>[9]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[15]%
\>[15]\AgdaBound{x≢y} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{\#?} \AgdaBound{M}\<%
\\
\>\AgdaSymbol{...} \<[19]%
\>[19]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \<[26]%
\>[26]\AgdaBound{x\#M} \AgdaSymbol{=} \AgdaInductiveConstructor{yes} \AgdaSymbol{(}\AgdaInductiveConstructor{\#ƛ} \AgdaBound{x\#M}\AgdaSymbol{)} \<[45]%
\>[45]\<%
\\
\>\AgdaBound{x} \AgdaFunction{\#?} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{)} \<[13]%
\>[13]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaBound{w} \<[9]%
\>[9]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[15]%
\>[15]\AgdaBound{x≢w} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[25]%
\>[25]\AgdaBound{¬x\#M} \AgdaSymbol{=} \AgdaInductiveConstructor{no} \AgdaSymbol{(}\AgdaFunction{aux} \AgdaBound{x≢w} \AgdaBound{¬x\#M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where} \AgdaFunction{aux} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{w} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaFunction{≢} \AgdaBound{w} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M}\AgdaSymbol{)} \AgdaSymbol{→} \<[47]%
\>[47]\AgdaBound{x} \AgdaDatatype{\#} \AgdaInductiveConstructor{ƛ} \AgdaBound{w} \AgdaBound{M} \AgdaSymbol{→} \AgdaDatatype{⊥}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{aux} \AgdaBound{x≢w} \AgdaBound{¬x\#ƛwM} \AgdaInductiveConstructor{\#ƛ≡} \<[35]%
\>[35]\AgdaSymbol{=} \<[38]%
\>[38]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢w} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaFunction{aux} \AgdaBound{x≢w} \AgdaBound{¬x\#ƛwM} \AgdaSymbol{(}\AgdaInductiveConstructor{\#ƛ} \AgdaBound{x\#ƛwM}\AgdaSymbol{)} \<[35]%
\>[35]\AgdaSymbol{=} \<[38]%
\>[38]\AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{¬x\#ƛwM} \AgdaBound{x\#ƛwM}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{lemma¬\#→free} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M}\<%
\\
\>\AgdaFunction{lemma¬\#→free} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{v} \AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{¬x\#M} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟} \AgdaBound{x}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{y≢x} \<[16]%
\>[16]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{¬x\#M} \AgdaSymbol{(}\AgdaInductiveConstructor{\#v} \AgdaBound{y≢x}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemma¬\#→free} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{v} \AgdaSymbol{.}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{¬x\#M} \<[29]%
\>[29]\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaInductiveConstructor{refl} \<[16]%
\>[16]\AgdaSymbol{=} \AgdaInductiveConstructor{*v}\<%
\\
\>\AgdaFunction{lemma¬\#→free} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \AgdaBound{¬x\#MN} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{\#?} \AgdaBound{M} \AgdaSymbol{|} \AgdaBound{x} \AgdaFunction{\#?} \AgdaBound{N} \<[52]%
\>[52]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#N} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{¬x\#MN} \AgdaSymbol{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaBound{x\#N}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{*·r} \AgdaSymbol{(}\AgdaFunction{lemma¬\#→free} \AgdaBound{¬x\#N}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{*·l} \AgdaSymbol{(}\AgdaFunction{lemma¬\#→free} \AgdaBound{¬x\#M}\AgdaSymbol{)}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#M} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#N} \AgdaSymbol{=} \AgdaInductiveConstructor{*·r} \AgdaSymbol{(}\AgdaFunction{lemma¬\#→free} \AgdaBound{¬x\#N}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma¬\#→free} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{¬x\#λxM} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟} \AgdaBound{x}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{y≢x} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{\#?} \AgdaBound{M}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{x\#M} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{¬x\#λxM} \AgdaSymbol{(}\AgdaInductiveConstructor{\#ƛ} \AgdaBound{x\#M}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬x\#M} \AgdaSymbol{=} \AgdaInductiveConstructor{*ƛ} \AgdaSymbol{(}\AgdaFunction{lemma¬\#→free} \AgdaBound{¬x\#M}\AgdaSymbol{)} \AgdaBound{y≢x}\<%
\\
\>\AgdaFunction{lemma¬\#→free} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{¬x\#λxM} \<[33]%
\>[33]\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaInductiveConstructor{refl} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{¬x\#λxM} \AgdaInductiveConstructor{\#ƛ≡}\AgdaSymbol{)}\<%
\\
\>\AgdaComment{--}\<%
\\
\>\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \AgdaSymbol{→} \<[42]%
\>[42]\AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{v} \AgdaSymbol{.}\AgdaBound{x}\AgdaSymbol{\}} \AgdaInductiveConstructor{*v} \<[39]%
\>[39]\AgdaSymbol{(}\AgdaInductiveConstructor{\#v} \AgdaBound{x≢x}\AgdaSymbol{)} \<[48]%
\>[48]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢x} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{*·l} \AgdaBound{xfreeM}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaBound{x\#N}\AgdaSymbol{)} \<[52]%
\>[52]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{((}\AgdaFunction{lemma-free→¬\#} \AgdaBound{xfreeM}\AgdaSymbol{)} \AgdaBound{x\#M}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{*·r} \AgdaBound{xfreeN}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaBound{x\#N}\AgdaSymbol{)} \<[52]%
\>[52]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{((}\AgdaFunction{lemma-free→¬\#} \AgdaBound{xfreeN}\AgdaSymbol{)} \AgdaBound{x\#N}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{*ƛ} \AgdaBound{xfreeM} \AgdaBound{x≢x}\AgdaSymbol{)} \AgdaInductiveConstructor{\#ƛ≡}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢x} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{*ƛ} \AgdaBound{xfreeM} \AgdaBound{y≢x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{\#ƛ} \AgdaBound{x\#M}\AgdaSymbol{)} \<[52]%
\>[52]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{((}\AgdaFunction{lemma-free→¬\#} \AgdaBound{xfreeM}\AgdaSymbol{)} \AgdaBound{x\#M}\AgdaSymbol{)}\<%
\\
\>\AgdaComment{--}\<%
\\
\>\AgdaFunction{lemma\#→¬free} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \AgdaSymbol{→} \AgdaFunction{¬} \AgdaSymbol{(}\AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma\#→¬free} \AgdaBound{x\#M} \AgdaBound{x*M} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{((}\AgdaFunction{lemma-free→¬\#} \AgdaBound{x*M}\AgdaSymbol{)} \AgdaBound{x\#M}\AgdaSymbol{)}\<%
\end{code}}

Sameness of free variables is an important relation between terms, which is defined as follows:

\begin{code}%
\>\AgdaFunction{\_∼*\_} \AgdaSymbol{:} \AgdaSymbol{(}\AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaBound{M} \AgdaFunction{∼*} \AgdaBound{M'} \AgdaSymbol{=} \AgdaSymbol{(∀} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M'}\AgdaSymbol{)} \AgdaFunction{×} \AgdaSymbol{(∀} \AgdaBound{x} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{∼*ρ} \AgdaSymbol{:} \AgdaFunction{Reflexive} \AgdaFunction{\_∼*\_}\<%
\\
\>\AgdaFunction{∼*ρ} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{id}\AgdaSymbol{)} \AgdaInductiveConstructor{∶} \AgdaSymbol{(λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{id}\AgdaSymbol{)} \<%
\end{code}

%<*typeweakening#>
\begin{code}%
\>\AgdaFunction{lemmaWeakening⊢\#} \<[18]%
\>[18]\AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaBound{β} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}} \<[56]%
\>[56]\<%
\\
\>[2]\AgdaIndent{18}{}\<[18]%
\>[18]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaFunction{‚} \AgdaBound{x} \AgdaInductiveConstructor{∶} \AgdaBound{β} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α}\<%
\end{code}
%</typeweakening#>

\begin{code}%
\>\AgdaFunction{lemmaWeakening⊢\#} \AgdaSymbol{(}\AgdaInductiveConstructor{\#v} \AgdaBound{y≢x}\AgdaSymbol{)} \<[31]%
\>[31]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢v} \AgdaBound{y∈Γ}\AgdaSymbol{)} \<[49]%
\>[49]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢v} \AgdaSymbol{(}\AgdaInductiveConstructor{there} \AgdaSymbol{(}\AgdaFunction{⊥-elim} \AgdaFunction{∘} \AgdaBound{y≢x}\AgdaSymbol{)} \AgdaBound{y∈Γ}\AgdaSymbol{)} \<[34]%
\>[34]\<%
\\
\>\AgdaFunction{lemmaWeakening⊢\#} \AgdaSymbol{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaBound{x\#N}\AgdaSymbol{)} \<[31]%
\>[31]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaBound{Γ⊢M∶α⟶β} \AgdaBound{Γ⊢N∶α}\AgdaSymbol{)} \<[51]%
\>[51]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢·} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢\#} \AgdaBound{x\#M} \AgdaBound{Γ⊢M∶α⟶β}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢\#} \AgdaBound{x\#N} \AgdaBound{Γ⊢N∶α}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaWeakening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{x} \AgdaSymbol{=} \AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x\#ƛyM} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,y↦β⊢M∶α}\AgdaSymbol{)} \<[58]%
\>[58]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaBound{x\#ƛyM} \<[14]%
\>[14]\AgdaSymbol{|} \AgdaBound{y} \AgdaFunction{≟} \AgdaBound{x} \<[22]%
\>[22]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{\#ƛ} \AgdaBound{x\#M} \<[14]%
\>[14]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[21]%
\>[21]\AgdaBound{y≢x} \<[27]%
\>[27]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaSymbol{(}\AgdaFunction{lemma⊆xy} \AgdaBound{y≢x}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢\#} \AgdaBound{x\#M} \AgdaBound{Γ,y↦β⊢M∶α}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{lemmaWeakening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{x} \AgdaSymbol{=} \AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x\#ƛyM} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x↦β⊢M∶α}\AgdaSymbol{)} \<[59]%
\>[59]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaInductiveConstructor{\#ƛ≡} \<[14]%
\>[14]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[21]%
\>[21]\AgdaBound{y≢x} \<[27]%
\>[27]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{y≢x} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaWeakening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{x} \AgdaSymbol{=} \AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{x\#ƛyM} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x↦β⊢M∶α}\AgdaSymbol{)} \<[59]%
\>[59]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{|} \AgdaSymbol{\_} \<[14]%
\>[14]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \<[21]%
\>[21]\AgdaInductiveConstructor{refl} \<[27]%
\>[27]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaFunction{lemma⊆x} \AgdaBound{Γ,x↦β⊢M∶α}\AgdaSymbol{)}\<%
\end{code}

%<*typeweakening#>
\begin{code}%
\>\AgdaFunction{lemmaStrengthening⊢\#} \<[22]%
\>[22]\AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaBound{β} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}} \<[60]%
\>[60]\<%
\\
\>[2]\AgdaIndent{22}{}\<[22]%
\>[22]\AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{\#} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaFunction{‚} \AgdaBound{x} \AgdaInductiveConstructor{∶} \AgdaBound{β} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaSymbol{(}\AgdaInductiveConstructor{\#v} \AgdaBound{x≢x}\AgdaSymbol{)} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢v} \AgdaSymbol{(}\AgdaInductiveConstructor{here} \AgdaInductiveConstructor{refl}\AgdaSymbol{))} \<[57]%
\>[57]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢x} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaBound{x\#M} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢v} \AgdaSymbol{(}\AgdaInductiveConstructor{there} \AgdaBound{y≢x} \AgdaBound{y∈Γ}\AgdaSymbol{))} \<[57]%
\>[57]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢v} \AgdaBound{y∈Γ}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaSymbol{(}\AgdaInductiveConstructor{\#·} \AgdaBound{x\#M} \AgdaBound{x\#N}\AgdaSymbol{)} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaBound{Γ,x∶β⊢M∶α'⟶β'} \AgdaBound{Γ,x:β⊢N∶α'}\AgdaSymbol{)} \<[65]%
\>[65]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢·} \<[8]%
\>[8]\AgdaSymbol{(}\AgdaFunction{lemmaStrengthening⊢\#} \AgdaBound{x\#M} \AgdaBound{Γ,x∶β⊢M∶α'⟶β'}\AgdaSymbol{)} \<[49]%
\>[49]\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{(}\AgdaFunction{lemmaStrengthening⊢\#} \AgdaBound{x\#N} \AgdaBound{Γ,x:β⊢N∶α'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \<[37]%
\>[37]\<%
\\
\>[8]\AgdaIndent{21}{}\<[21]%
\>[21]\AgdaBound{x\#ƛyM} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x:β,y:α'⊢M∶β'}\AgdaSymbol{)} \<[56]%
\>[56]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟} \AgdaBound{y}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \<[38]%
\>[38]\<%
\\
\>[2]\AgdaIndent{21}{}\<[21]%
\>[21]\AgdaBound{x\#ƛxM} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x:β,x:α'⊢M∶β'}\AgdaSymbol{)} \<[56]%
\>[56]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaInductiveConstructor{refl} \<[13]%
\>[13]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaFunction{lemma⊆xx} \AgdaBound{Γ,x:β,x:α'⊢M∶β'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \<[38]%
\>[38]\<%
\\
\>[2]\AgdaIndent{21}{}\<[21]%
\>[21]\AgdaInductiveConstructor{\#ƛ≡} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x:β,x:α'⊢M∶β'}\AgdaSymbol{)} \<[56]%
\>[56]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢x} \<[13]%
\>[13]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaBound{x≢x} \AgdaInductiveConstructor{refl}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemmaStrengthening⊢\#} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \<[37]%
\>[37]\<%
\\
\>[2]\AgdaIndent{21}{}\<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{\#ƛ} \AgdaBound{x\#M}\AgdaSymbol{)} \<[35]%
\>[35]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x:β,y:α'⊢M∶β'}\AgdaSymbol{)} \<[56]%
\>[56]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{x≢y} \<[13]%
\>[13]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemmaStrengthening⊢\#} \AgdaBound{x\#M} \AgdaSymbol{(}\AgdaFunction{lemmaWeakening⊢} \AgdaSymbol{(}\AgdaFunction{lemma⊆xy} \AgdaBound{x≢y}\AgdaSymbol{)} \AgdaBound{Γ,x:β,y:α'⊢M∶β'}\AgdaSymbol{))}\<%
\end{code}
%</typeweakening#>


-- %<*typeStrengthening> 
-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemmaStrengthening⊢\#  : \{Γ : Cxt\}\{M : Λ\}\{x : V\}\{α : Type\} }\<%
\\
\>\AgdaComment{--                       → x \# M → Γ ⊢ M ∶ α → Γ \textbackslash\textbackslash x ⊢ M ∶ α }\<%
\\
\>\AgdaComment{-- }\<%
\end{code}
-- %</typeStrengthening>

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemmaStrengthening⊢\# (\#v y≢x) (⊢v y∈Γ) }\<%
\\
\>\AgdaComment{--   with lemma\textbackslash\textbackslash← y≢x y∈Γ}\<%
\\
\>\AgdaComment{-- ... | y∈Γ\textbackslash\textbackslashx ∶ Γ⟨y∈Γ⟩≡Γ\textbackslash\textbackslash⟨y∈Γ\textbackslash\textbackslashx⟩}\<%
\\
\>\AgdaComment{--   rewrite Γ⟨y∈Γ⟩≡Γ\textbackslash\textbackslash⟨y∈Γ\textbackslash\textbackslashx⟩}\<%
\\
\>\AgdaComment{--   = ⊢v y∈Γ\textbackslash\textbackslashx}\<%
\\
\>\AgdaComment{-- lemmaStrengthening⊢\# (\#· x\#M x\#N) (⊢· Γ⊢M∶α⟶β Γ⊢N∶α) }\<%
\\
\>\AgdaComment{--   = ⊢· (lemmaStrengthening⊢\# x\#M Γ⊢M∶α⟶β) (lemmaStrengthening⊢\# x\#N Γ⊢N∶α)  }\<%
\\
\>\AgdaComment{-- lemmaStrengthening⊢\# x\#M (⊢ƛ Γ,y:α⊢M∶β) }\<%
\\
\>\AgdaComment{--   = \{!!\}}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

%<*typeStrengthening> 
\begin{code}%
\>\AgdaComment{-- postulate}\<%
\\
\>\AgdaComment{--    lemmaStrengthening⊢,\#  : \{Γ : Cxt\}\{M : Λ\}\{x : V\}\{α β : Type\} }\<%
\\
\>\AgdaComment{--                           → x \# M → Γ  ⊢ M ∶ α → Γ ‚ x ∶ β ⊢ M ∶ α }\<%
\\
%
\\
\>\AgdaComment{-- lemma⊢*∈  : \{Γ : Cxt\}\{M : Λ\}\{x : V\}\{α : Type\} }\<%
\\
\>\AgdaComment{--           → Γ ⊢ M ∶ α → x * M → x ∈ Γ}\<%
\\
\>\AgdaComment{-- lemma⊢*∈ (⊢v x∈Γ)             *v            = x∈Γ}\<%
\\
\>\AgdaComment{-- lemma⊢*∈ (⊢· Γ⊢M:α⟶β Γ⊢N:α)  (*·l x*M)     = lemma⊢*∈ Γ⊢M:α⟶β x*M}\<%
\\
\>\AgdaComment{-- lemma⊢*∈ (⊢· Γ⊢M:α⟶β Γ⊢N:α)  (*·r x*N)     = lemma⊢*∈ Γ⊢N:α x*N}\<%
\\
\>\AgdaComment{-- lemma⊢*∈ (⊢ƛ Γ,y:α⊢M:β)       (*ƛ x*M y≢x) with lemma⊢*∈ Γ,y:α⊢M:β x*M}\<%
\\
\>\AgdaComment{-- ... | here x≡y     = ⊥-elim (y≢x (sym x≡y))}\<%
\\
\>\AgdaComment{-- ... | there \_ x∈Γ  = x∈Γ}\<%
\\
%
\\
\>\AgdaComment{-- lemmaStrengthening⊢⊆\#  : \{Γ : Cxt\}\{M : Λ\}\{α : Type\} }\<%
\\
\>\AgdaComment{--                        → Γ ⊢ M ∶ α → Σₓ Cxt (λ Δ → (Δ ⊢ M ∶ α) × (Δ ⊆ Γ) × ((x : V) → x ∈ Δ → x * M))}\<%
\\
\>\AgdaComment{-- lemmaStrengthening⊢⊆\# \{[]\}                Γ⊢M∶α = [] ∶  Γ⊢M∶α ∶  ρ⊆ ∶ λ x ()}\<%
\\
\>\AgdaComment{-- lemmaStrengthening⊢⊆\# \{(x ∶ β) ∷ Γ\}  \{M\}  Γ,x:β⊢M∶α }\<%
\\
\>\AgdaComment{--   with x \#? M}\<%
\\
\>\AgdaComment{-- ... | no ¬x\#M  = \{!!\} }\<%
\\
\>\AgdaComment{-- ... | yes x\#M  with lemmaStrengthening⊢⊆\# \{Γ\} \{M\} (lemmaStrengthening⊢,\# x\#M Γ,x:β⊢M∶α)}\<%
\\
\>\AgdaComment{-- ...            | Δ ∶ Δ⊢M∶α ∶ Δ⊆Γ ∶ ∀x→x∈Δ→x*M }\<%
\\
\>\AgdaComment{--   = Δ ∶ Δ⊢M∶α ∶ Δ⊆Γ,x∶β ∶ ∀x→x∈Δ→x*M }\<%
\\
\>\AgdaComment{--   where}\<%
\\
\>\AgdaComment{--   Δ⊆Γ,x∶β : Δ ⊆ Γ ‚ x ∶ β}\<%
\\
\>\AgdaComment{--   Δ⊆Γ,x∶β  \{z\} z∈Δ with z ≟ x}\<%
\\
\>\AgdaComment{--   ... | no  z≢x   = there z≢x (proj₁ (Δ⊆Γ z∈Δ)) ∶ proj₂ (Δ⊆Γ z∈Δ)}\<%
\\
\>\AgdaComment{--   Δ⊆Γ,x∶β  .\{x\} x∈Δ }\<%
\\
\>\AgdaComment{--       | yes refl  = ⊥-elim ((lemma\#→¬free x\#M) (∀x→x∈Δ→x*M x x∈Δ))}\<%
\end{code}
%</typeStrengthening>

\begin{code}%
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation} \AgdaDatatype{Λ}\<%
\\
%
\\
\>\AgdaFunction{dual-\#-*} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{R} \AgdaSymbol{:} \AgdaFunction{Rel}\AgdaSymbol{\}\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_\#\_} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaBound{R} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_*\_} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{dual} \AgdaBound{R}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{dual-\#-*} \AgdaSymbol{\{}\AgdaBound{R}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{\#-pres-R} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaBound{y*m} \AgdaBound{m'Rm} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{\#?} \AgdaBound{m'}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y\#m'} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaFunction{lemma-free→¬\#} \AgdaBound{y*m} \AgdaSymbol{(}\AgdaBound{\#-pres-R} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaBound{y\#m'} \AgdaBound{m'Rm}\AgdaSymbol{))}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬y\#m'} \AgdaSymbol{=} \AgdaFunction{lemma¬\#→free} \AgdaBound{¬y\#m'}\<%
\\
%
\\
\>\AgdaFunction{dual-*-\#} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{R} \AgdaSymbol{:} \AgdaFunction{Rel}\AgdaSymbol{\}\{}\AgdaBound{y} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_*\_} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{dual} \AgdaBound{R}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_\#\_} \AgdaBound{y}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaBound{R}\<%
\\
\>\AgdaFunction{dual-*-\#} \AgdaSymbol{\{}\AgdaBound{R}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{*-pres-R} \AgdaSymbol{\{}\AgdaBound{m}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{m'}\AgdaSymbol{\}} \AgdaBound{y\#m} \AgdaBound{m'Rm} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{\#?} \AgdaBound{m'}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaBound{y\#m'} \AgdaSymbol{=} \AgdaBound{y\#m'}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{¬y\#m'} \AgdaSymbol{=} \AgdaFunction{⊥-elim} \AgdaSymbol{(}\AgdaFunction{lemma-free→¬\#} \AgdaSymbol{(}\AgdaBound{*-pres-R} \AgdaSymbol{(}\AgdaFunction{lemma¬\#→free} \AgdaBound{¬y\#m'}\AgdaSymbol{)} \AgdaBound{m'Rm}\AgdaSymbol{)} \AgdaBound{y\#m}\AgdaSymbol{)} \<%
\end{code}


