\begin{code}%
\>\AgdaKeyword{module} \AgdaModule{Beta} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Chi}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Term}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Substitution}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{SubstitutionLemmas}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Alpha}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation} \AgdaDatatype{Λ} \AgdaKeyword{hiding} \AgdaSymbol{(}\_++\_\AgdaSymbol{)} \AgdaKeyword{renaming} \AgdaSymbol{(}\_⊆\_ \AgdaSymbol{to} \_⊆R\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{NaturalProp}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{ListProperties}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Empty}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Sum}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat} \AgdaKeyword{hiding} \AgdaSymbol{(}\_*\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Nullary}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary} \AgdaKeyword{hiding} \AgdaSymbol{(}Rel\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Function} \AgdaKeyword{hiding} \AgdaSymbol{(}\_∘\_\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Product} \AgdaKeyword{renaming} \AgdaSymbol{(}Σ \AgdaSymbol{to} Σₓ\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality} \AgdaSymbol{as} \AgdaModule{PropEq}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{using} \AgdaSymbol{(}\_≡\_\AgdaSymbol{;} \_≢\_\AgdaSymbol{;} refl\AgdaSymbol{;} sym\AgdaSymbol{;} cong\AgdaSymbol{;} cong₂\AgdaSymbol{;} setoid\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{PropEq.}\AgdaModule{≡-Reasoning} \AgdaKeyword{renaming} \AgdaSymbol{(}begin\_ \AgdaSymbol{to} begin≡\_\AgdaSymbol{;}\_∎ \AgdaSymbol{to} \_◻\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List} \AgdaKeyword{hiding} \AgdaSymbol{(}any\AgdaSymbol{)} \AgdaKeyword{renaming} \AgdaSymbol{(}length \AgdaSymbol{to} length'\AgdaSymbol{)} \<[64]%
\>[64]\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List.Properties}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List.Any} \AgdaSymbol{as} \AgdaModule{Any} \AgdaKeyword{hiding} \AgdaSymbol{(}map\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.List.Any.Membership}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{Any.}\AgdaModule{Membership-≡} \AgdaKeyword{hiding} \AgdaSymbol{(}\_⊆\_\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{infix} \<[8]%
\>[8]\AgdaNumber{1} \_▹\_ \<%
\\
\>\<%
\end{code}

Beta contraction

%<*betacontraction>
\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{\_▹\_} \AgdaSymbol{:} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{▹β} \<[6]%
\>[6]\AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \<[26]%
\>[26]\<%
\\
\>[2]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaSymbol{→} \<[9]%
\>[9]\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaDatatype{▹} \AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)}\<%
\end{code}
%</betacontraction>

Beta contraction preserves typing judge.

%<*typebeta>
\begin{code}%
\>\AgdaFunction{lemma⊢▹} \<[9]%
\>[9]\AgdaSymbol{:} \<[12]%
\>[12]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[41]%
\>[41]\<%
\\
\>[6]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \<[12]%
\>[12]\AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{▹} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{α}\<%
\end{code}
%</typebeta>

%<*typebetaproof>
\begin{code}%
\>\AgdaFunction{lemma⊢▹} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaSymbol{.\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{α}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{β}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{Γ,x:α⊢M:β}\AgdaSymbol{)} \AgdaBound{Γ⊢N:α}\AgdaSymbol{)} \AgdaInductiveConstructor{▹β} \<[74]%
\>[74]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemma⊢σM} \<[14]%
\>[14]\AgdaSymbol{\{}\AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)\}} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaFunction{‚} \AgdaBound{x} \AgdaInductiveConstructor{∶} \AgdaBound{α}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \<[49]%
\>[49]\<%
\\
\>[2]\AgdaIndent{14}{}\<[14]%
\>[14]\AgdaBound{Γ,x:α⊢M:β}\<%
\\
\>[2]\AgdaIndent{14}{}\<[14]%
\>[14]\AgdaSymbol{(}\AgdaFunction{lemma⇀} \AgdaSymbol{(}\AgdaFunction{lemmaι≺+⇀} \AgdaBound{Γ⊢N:α}\AgdaSymbol{))}\<%
\end{code}
%</typebetaproof>

%<*typeiota>
\begin{code}%
\>\AgdaFunction{lemma⊢ι} \<[9]%
\>[9]\AgdaSymbol{:} \<[12]%
\>[12]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[39]%
\>[39]\<%
\\
\>[0]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \<[12]%
\>[12]\AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α}\<%
\\
\>\AgdaFunction{lemma⊢ι} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{v} \AgdaBound{x}\AgdaSymbol{\}} \<[21]%
\>[21]\AgdaBound{Γ⊢x:α} \<[31]%
\>[31]\AgdaSymbol{=} \AgdaBound{Γ⊢x:α}\<%
\\
\>\AgdaFunction{lemma⊢ι} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaBound{Γ⊢Mι:α⟶β} \AgdaBound{Γ⊢Nι:α}\AgdaSymbol{)} \<[42]%
\>[42]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢·} \AgdaSymbol{(}\AgdaFunction{lemma⊢ι} \AgdaBound{Γ⊢Mι:α⟶β}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma⊢ι} \AgdaBound{Γ⊢Nι:α}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma⊢ι} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \<[21]%
\>[21]\AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,y:α⊢Mι≺+x,y:α}\AgdaSymbol{)} \<[43]%
\>[43]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaFunction{lemma⊢σM} \AgdaBound{Γ,y:α⊢Mι≺+x,y:α} \AgdaSymbol{(}\AgdaFunction{lemmaι≺+⇀y} \AgdaSymbol{\{}\AgdaArgument{x} \AgdaSymbol{=} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{χ} \AgdaSymbol{(}\AgdaFunction{ι} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\})}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaBound{Γ,x:α⊢Mι≺+x,yι≺y,x:β} \AgdaKeyword{rewrite} \AgdaFunction{lemma≺+ι} \AgdaSymbol{(}\AgdaFunction{lemma-χι} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemma⊢ι} \AgdaBound{Γ,x:α⊢Mι≺+x,yι≺y,x:β}\AgdaSymbol{)}\<%
\end{code}
%</typeiota>

%<*typealpha>
\begin{code}%
\>\AgdaFunction{lemma⊢α} \<[9]%
\>[9]\AgdaSymbol{:} \<[12]%
\>[12]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[41]%
\>[41]\<%
\\
\>[2]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{∼α} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{α}\<%
\end{code}
%</typealpha>

%<*typealphaproof>
\begin{code}%
\>\AgdaFunction{lemma⊢α} \AgdaSymbol{\{}\AgdaArgument{M} \AgdaSymbol{=} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaArgument{N} \AgdaSymbol{=} \AgdaBound{N}\AgdaSymbol{\}} \AgdaBound{Γ⊢M} \AgdaBound{M∼N} \<[32]%
\>[32]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \<[16]%
\>[16]\AgdaSymbol{|} \AgdaFunction{lemma⊢σM} \AgdaBound{Γ⊢M} \AgdaSymbol{(}\AgdaFunction{lemma⇀} \AgdaFunction{lemmaι⇀}\AgdaSymbol{)} \<[49]%
\>[49]\AgdaSymbol{|} \AgdaFunction{lemmaM∼M'→Mσ≡M'σ} \AgdaSymbol{\{}\AgdaArgument{σ} \AgdaSymbol{=} \AgdaFunction{ι}\AgdaSymbol{\}} \AgdaBound{M∼N} \<[80]%
\>[80]\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaSymbol{.(}\AgdaBound{N} \AgdaFunction{∙} \AgdaFunction{ι}\AgdaSymbol{)} \<[16]%
\>[16]\AgdaSymbol{|} \AgdaBound{Γ⊢N∙ι} \<[40]%
\>[40]\AgdaSymbol{|} \AgdaInductiveConstructor{refl} \<[47]%
\>[47]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemma⊢ι} \AgdaBound{Γ⊢N∙ι}\<%
\end{code}
%</typealphaproof>

Context clousure of beta contraction.

\end{code}

%<*beta>
\begin{code}%
\>\AgdaKeyword{data} \AgdaDatatype{ctx} \AgdaSymbol{(}\AgdaBound{r} \AgdaSymbol{:} \AgdaFunction{Rel}\AgdaSymbol{)} \AgdaSymbol{:} \AgdaFunction{Rel} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ctxinj} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{t} \AgdaBound{t'}\AgdaSymbol{\}} \<[26]%
\>[26]\AgdaSymbol{→} \AgdaBound{r} \AgdaBound{t} \AgdaBound{t'} \<[42]%
\>[42]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaBound{t} \AgdaBound{t'}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ctx·l} \<[9]%
\>[9]\AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{t₁} \AgdaBound{t₁'} \AgdaBound{t₂}\AgdaSymbol{\}} \<[26]%
\>[26]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaBound{t₁} \AgdaBound{t₁'} \<[42]%
\>[42]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaSymbol{(}\AgdaBound{t₁} \AgdaInductiveConstructor{·} \AgdaBound{t₂}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t₁'} \AgdaInductiveConstructor{·} \AgdaBound{t₂}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ctx·r} \<[9]%
\>[9]\AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{t₁} \AgdaBound{t₂} \AgdaBound{t₂'}\AgdaSymbol{\}} \<[26]%
\>[26]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaBound{t₂} \AgdaBound{t₂'} \<[42]%
\>[42]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaSymbol{(}\AgdaBound{t₁} \AgdaInductiveConstructor{·} \AgdaBound{t₂}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{t₁} \AgdaInductiveConstructor{·} \AgdaBound{t₂'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{ctxƛ} \<[9]%
\>[9]\AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{t₁} \AgdaBound{t₁'}\AgdaSymbol{\}} \<[26]%
\>[26]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaBound{t₁} \AgdaBound{t₁'} \<[42]%
\>[42]\AgdaSymbol{→} \AgdaDatatype{ctx} \AgdaBound{r} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{t₁}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{t₁'}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{infix} \AgdaNumber{4} \_→β\_\<%
\\
\>\AgdaFunction{\_→β\_} \AgdaSymbol{:} \AgdaFunction{Rel}\<%
\\
\>\AgdaFunction{\_→β\_} \AgdaSymbol{=} \AgdaDatatype{ctx} \AgdaDatatype{\_▹\_}\<%
\end{code}
%</beta>

\begin{code}%
\>\AgdaFunction{lemma⊢→β} \AgdaSymbol{:} \<[12]%
\>[12]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[41]%
\>[41]\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→β} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{α}\<%
\\
\>\AgdaFunction{lemma⊢→β} \AgdaBound{Γ⊢M:α} \<[29]%
\>[29]\AgdaSymbol{(}\AgdaInductiveConstructor{ctxinj} \<[38]%
\>[38]\AgdaBound{M▹N}\AgdaSymbol{)} \<[46]%
\>[46]\AgdaSymbol{=} \AgdaFunction{lemma⊢▹} \AgdaBound{Γ⊢M:α} \AgdaBound{M▹N}\<%
\\
\>\AgdaFunction{lemma⊢→β} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaBound{Γ⊢M:α→β} \AgdaBound{Γ⊢N:α}\AgdaSymbol{)} \<[29]%
\>[29]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·l} \<[38]%
\>[38]\AgdaBound{M→βM'}\AgdaSymbol{)} \<[46]%
\>[46]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢·} \AgdaSymbol{(}\AgdaFunction{lemma⊢→β} \AgdaBound{Γ⊢M:α→β} \AgdaBound{M→βM'}\AgdaSymbol{)} \AgdaBound{Γ⊢N:α}\<%
\\
\>\AgdaFunction{lemma⊢→β} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢·} \AgdaBound{Γ⊢M:α→β} \AgdaBound{Γ⊢N:α}\AgdaSymbol{)} \<[29]%
\>[29]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·r} \<[38]%
\>[38]\AgdaBound{N→βN'}\AgdaSymbol{)} \<[46]%
\>[46]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢·} \AgdaBound{Γ⊢M:α→β} \AgdaSymbol{(}\AgdaFunction{lemma⊢→β} \AgdaBound{Γ⊢N:α} \AgdaBound{N→βN'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma⊢→β} \AgdaSymbol{(}\AgdaInductiveConstructor{⊢ƛ} \AgdaBound{Γ,x:α⊢M:α}\AgdaSymbol{)} \<[29]%
\>[29]\AgdaSymbol{(}\AgdaInductiveConstructor{ctxƛ} \<[38]%
\>[38]\AgdaBound{M→βN}\AgdaSymbol{)} \<[46]%
\>[46]\AgdaSymbol{=} \AgdaInductiveConstructor{⊢ƛ} \AgdaSymbol{(}\AgdaFunction{lemma⊢→β} \AgdaBound{Γ,x:α⊢M:α} \AgdaBound{M→βN}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{infix} \AgdaNumber{4} \_→α\_ \<%
\\
\>\<%
\end{code}

%<*alphabeta>
\begin{code}%
\>\AgdaFunction{\_→α\_} \AgdaSymbol{:} \AgdaFunction{Rel}\<%
\\
\>\AgdaFunction{\_→α\_} \AgdaSymbol{=} \AgdaFunction{\_→β\_} \AgdaFunction{∪} \AgdaDatatype{\_∼α\_}\<%
\end{code}
%</alphabeta>

\begin{code}%
\>\AgdaFunction{lemma⊢→α} \AgdaSymbol{:} \<[12]%
\>[12]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[41]%
\>[41]\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{α}\<%
\\
\>\AgdaFunction{lemma⊢→α} \AgdaBound{Γ⊢M:α} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{M→βN}\AgdaSymbol{)} \<[28]%
\>[28]\AgdaSymbol{=} \AgdaFunction{lemma⊢→β} \AgdaBound{Γ⊢M:α} \AgdaBound{M→βN}\<%
\\
\>\AgdaFunction{lemma⊢→α} \AgdaBound{Γ⊢M:α} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaBound{M\textasciitildeN}\AgdaSymbol{)} \<[28]%
\>[28]\AgdaSymbol{=} \AgdaFunction{lemma⊢α} \AgdaBound{Γ⊢M:α} \AgdaBound{M\textasciitildeN}\<%
\\
%
\\
\>\AgdaKeyword{infix} \AgdaNumber{4} \_→α*\_\<%
\\
%
\\
\>\<%
\end{code}

%<*asteralphabeta>
\begin{code}%
\>\AgdaFunction{\_→α*\_} \AgdaSymbol{:} \AgdaFunction{Rel}\<%
\\
\>\AgdaFunction{\_→α*\_} \AgdaSymbol{=} \AgdaDatatype{star} \AgdaFunction{\_→α\_}\<%
\end{code}
%</asteralphabeta>

\begin{code}%
\>\AgdaKeyword{infix} \AgdaNumber{3} \_→α*ₛ\_\<%
\\
\>\AgdaFunction{\_→α*ₛ\_} \AgdaSymbol{:} \AgdaFunction{Σ} \AgdaSymbol{→} \AgdaFunction{Σ} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{σ} \AgdaBound{x} \AgdaFunction{→α*} \AgdaBound{σ'} \AgdaBound{x} \<[35]%
\>[35]\<%
\\
%
\\
\>\AgdaKeyword{infix} \AgdaNumber{3} \_→α*ₛ\_⇂\_\<%
\\
\>\AgdaFunction{\_→α*ₛ\_⇂\_} \AgdaSymbol{:} \AgdaFunction{Σ} \AgdaSymbol{→} \AgdaFunction{Σ} \AgdaSymbol{→} \AgdaDatatype{Λ} \AgdaSymbol{→} \AgdaPrimitiveType{Set}\<%
\\
\>\AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{⇂} \AgdaBound{M} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{x} \AgdaDatatype{*} \AgdaBound{M} \AgdaSymbol{→} \AgdaBound{σ} \AgdaBound{x} \AgdaFunction{→α*} \AgdaBound{σ'} \AgdaBound{x} \<[47]%
\>[47]\<%
\\
%
\\
\>\AgdaFunction{lemma-→α*ₛ→→α*ₛ⇂} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{σ} \AgdaBound{σ'} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}(}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{⇂} \AgdaBound{M}\<%
\\
\>\AgdaFunction{lemma-→α*ₛ→→α*ₛ⇂} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ'}\AgdaSymbol{\}} \AgdaBound{M} \AgdaBound{σ→α*ₛσ'} \AgdaBound{z} \AgdaBound{z*M} \AgdaSymbol{=} \AgdaBound{σ→α*ₛσ'} \AgdaBound{z}\<%
\\
%
\\
\>\AgdaFunction{lemma-refl-→α*ₛ} \AgdaSymbol{:} \AgdaFunction{Reflexive} \AgdaFunction{\_→α*ₛ\_}\<%
\\
\>\AgdaFunction{lemma-refl-→α*ₛ} \AgdaBound{x} \AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
%
\\
\>\AgdaFunction{lemma-→α*ₛι} \AgdaSymbol{:} \AgdaFunction{ι} \AgdaFunction{→α*ₛ} \AgdaFunction{ι}\<%
\\
\>\AgdaFunction{lemma-→α*ₛι} \AgdaSymbol{=} \AgdaFunction{lemma-refl-→α*ₛ}\<%
\\
%
\\
\>\AgdaFunction{lemma-→α*ₛ≺+} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaBound{σ'} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma-→α*ₛ≺+} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaBound{σ→α*σ'} \AgdaBound{M→α*N} \AgdaBound{y} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[13]%
\>[13]\AgdaSymbol{=} \AgdaBound{M→α*N}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaSymbol{\_} \<[13]%
\>[13]\AgdaSymbol{=} \AgdaBound{σ→α*σ'} \AgdaBound{y}\<%
\\
%
\\
\>\AgdaFunction{lemma-→α*ₛ⇂≺+} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaBound{σ'} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{P} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{⇂} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{P} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)} \AgdaFunction{⇂} \AgdaBound{P}\<%
\\
\>\AgdaFunction{lemma-→α*ₛ⇂≺+} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaBound{σ→α*σ'} \AgdaBound{M→α*N} \AgdaBound{y} \AgdaBound{y*ƛxP} \AgdaKeyword{with} \AgdaBound{x} \AgdaFunction{≟} \AgdaBound{y}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaSymbol{\_} \<[15]%
\>[15]\AgdaSymbol{=} \AgdaBound{M→α*N}\<%
\\
\>\AgdaSymbol{...} \AgdaSymbol{|} \AgdaInductiveConstructor{no} \<[10]%
\>[10]\AgdaBound{x≢y} \<[15]%
\>[15]\AgdaSymbol{=} \AgdaBound{σ→α*σ'} \AgdaBound{y} \AgdaSymbol{(}\AgdaInductiveConstructor{*ƛ} \AgdaBound{y*ƛxP} \AgdaBound{x≢y}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{abs-step} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{t} \AgdaBound{t'}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{t} \AgdaFunction{→α} \AgdaBound{t'} \AgdaSymbol{→} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{t} \AgdaFunction{→α} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{t'}\<%
\\
\>\AgdaFunction{abs-step} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{M→βN}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{ctxƛ} \AgdaBound{M→βN}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{abs-step} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaBound{M∼N}\AgdaSymbol{)} \<[21]%
\>[21]\AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaFunction{lemma∼λ} \AgdaBound{M∼N}\AgdaSymbol{)} \<[42]%
\>[42]\<%
\\
%
\\
\>\AgdaFunction{abs-star} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{M} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{N} \AgdaSymbol{→} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M} \AgdaFunction{→α*} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{N}\<%
\\
\>\AgdaFunction{abs-star} \AgdaInductiveConstructor{refl} \<[30]%
\>[30]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{abs-star} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{M→αN}\AgdaSymbol{)} \<[30]%
\>[30]\AgdaSymbol{=} \AgdaInductiveConstructor{just} \<[39]%
\>[39]\AgdaSymbol{(}\AgdaFunction{abs-step} \AgdaBound{M→αN}\AgdaSymbol{)} \<[55]%
\>[55]\<%
\\
\>\AgdaFunction{abs-star} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{M→α*N} \AgdaBound{N→α*P}\AgdaSymbol{)} \<[30]%
\>[30]\AgdaSymbol{=} \AgdaInductiveConstructor{trans} \<[39]%
\>[39]\AgdaSymbol{(}\AgdaFunction{abs-star} \AgdaBound{M→α*N}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{abs-star} \AgdaBound{N→α*P}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{app-step-l} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α} \AgdaBound{P} \<[33]%
\>[33]\AgdaSymbol{→} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaFunction{→α} \AgdaBound{P} \AgdaInductiveConstructor{·} \AgdaBound{N}\<%
\\
\>\AgdaFunction{app-step-l} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{t→t'}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{ctx·l} \AgdaBound{t→t'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{app-step-l} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaBound{t∼t'}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼·} \AgdaBound{t∼t'} \AgdaFunction{∼ρ}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{app-step-r} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{→α} \AgdaBound{P} \AgdaSymbol{→} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaFunction{→α} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{P}\<%
\\
\>\AgdaFunction{app-step-r} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{t→t'}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{ctx·r} \AgdaBound{t→t'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{app-step-r} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaBound{t∼t'}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaInductiveConstructor{∼·} \AgdaFunction{∼ρ} \AgdaBound{t∼t'}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{app-star-l} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{P} \AgdaSymbol{→} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{P} \AgdaInductiveConstructor{·} \AgdaBound{N}\<%
\\
\>\AgdaFunction{app-star-l} \AgdaInductiveConstructor{refl} \<[36]%
\>[36]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{app-star-l} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{x}\AgdaSymbol{)} \<[36]%
\>[36]\AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaFunction{app-step-l} \AgdaBound{x}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{app-star-l} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{t→α*t'} \AgdaBound{t'→α*t''}\AgdaSymbol{)} \<[36]%
\>[36]\AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{(}\AgdaFunction{app-star-l} \AgdaBound{t→α*t'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{app-star-l} \AgdaBound{t'→α*t''}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{app-star-r} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{N} \AgdaBound{P}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{P} \AgdaSymbol{→} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{P}\<%
\\
\>\AgdaFunction{app-star-r} \AgdaInductiveConstructor{refl} \<[36]%
\>[36]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{app-star-r} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{t→α*t'}\AgdaSymbol{)} \<[36]%
\>[36]\AgdaSymbol{=} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaFunction{app-step-r} \AgdaBound{t→α*t'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{app-star-r} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{t→α*t'} \AgdaBound{t'→α*t''}\AgdaSymbol{)} \<[36]%
\>[36]\AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{(}\AgdaFunction{app-star-r} \AgdaBound{t→α*t'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{app-star-r} \AgdaBound{t'→α*t''}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{app-star} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaBound{N} \AgdaBound{N'}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{N'} \AgdaSymbol{→} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaInductiveConstructor{·} \AgdaBound{N'}\<%
\\
\>\AgdaFunction{app-star} \AgdaBound{M→α*M'} \AgdaBound{N→α*N'} \AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{(}\AgdaFunction{app-star-l} \AgdaBound{M→α*M'}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{app-star-r} \AgdaBound{N→α*N'}\AgdaSymbol{)}\<%
\end{code}

Reduction is a preorder over terms, hence we can use the combinators of
the standard library for proving the reduction of a term to another.

\begin{code}%
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Nullary}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality} \AgdaKeyword{renaming} \AgdaSymbol{(}sym \AgdaSymbol{to} sym'\AgdaSymbol{;}trans \AgdaSymbol{to} trans'\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary} \AgdaKeyword{using} \AgdaSymbol{(}Preorder\AgdaSymbol{)}\<%
\\
\>\AgdaKeyword{import} \AgdaModule{Relation.Binary.PreorderReasoning} \AgdaSymbol{as} \AgdaModule{PreR} \<[52]%
\>[52]\<%
\\
%
\\
\>\AgdaFunction{→-preorder} \AgdaSymbol{:} \AgdaRecord{Preorder} \AgdaSymbol{\_} \AgdaSymbol{\_} \AgdaSymbol{\_}\<%
\\
\>\AgdaFunction{→-preorder} \AgdaSymbol{=} \<[14]%
\>[14]\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaKeyword{record} \AgdaSymbol{\{} \<[13]%
\>[13]\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaField{Carrier} \AgdaSymbol{=} \AgdaDatatype{Λ}\AgdaSymbol{;}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaField{\_≈\_} \AgdaSymbol{=} \AgdaDatatype{\_≡\_}\AgdaSymbol{;}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaField{\_∼\_} \AgdaSymbol{=} \AgdaFunction{\_→α*\_}\AgdaSymbol{;}\<%
\\
\>[4]\AgdaIndent{6}{}\<[6]%
\>[6]\AgdaField{isPreorder} \AgdaSymbol{=} \<[20]%
\>[20]\AgdaKeyword{record} \AgdaSymbol{\{}\<%
\\
\>[6]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaField{isEquivalence} \AgdaSymbol{=} \AgdaField{Relation.Binary.Setoid.isEquivalence} \AgdaSymbol{(}\AgdaFunction{PropEq.setoid} \AgdaDatatype{Λ}\AgdaSymbol{)} \AgdaSymbol{;}\<%
\\
\>[6]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaField{reflexive} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaSymbol{.}\AgdaBound{M}\AgdaSymbol{\}} \AgdaInductiveConstructor{refl} \AgdaSymbol{→} \AgdaInductiveConstructor{refl}\AgdaSymbol{\};}\<%
\\
\>[6]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaField{trans} \AgdaSymbol{=} \AgdaInductiveConstructor{star.trans} \AgdaSymbol{\}} \<[29]%
\>[29]\<%
\\
\>[0]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaModule{PreR} \AgdaFunction{→-preorder} \AgdaKeyword{renaming} \AgdaSymbol{(}begin\_ \AgdaSymbol{to} begin→\_\AgdaSymbol{;}\_∼⟨\_⟩\_ \AgdaSymbol{to} \_→⟨\_⟩\_\AgdaSymbol{;}\_≈⟨\_⟩\_ \AgdaSymbol{to} \_=⟨\_⟩\_\AgdaSymbol{;}\_∎ \AgdaSymbol{to} \_▣\AgdaSymbol{)}\<%
\end{code}

Substitution lemma for $β$-reduction.

\begin{code}%
\>\AgdaFunction{lemma▹*} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_*\_} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{dual} \AgdaDatatype{\_▹\_}\AgdaSymbol{)} \AgdaComment{--\{M N : Λ\} → x * N → M ▹ N → x * M}\<%
\\
\>\AgdaFunction{lemma▹*} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{.\{}\AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)\}} \<[34]%
\>[34]\AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \<[47]%
\>[47]\AgdaBound{x*M[y/N]} \AgdaInductiveConstructor{▹β}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{with} \AgdaFunction{lemmafreeσ→} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{x*M[y/N]}\<%
\\
\>\AgdaSymbol{...} \<[5]%
\>[5]\AgdaSymbol{|} \AgdaBound{z} \AgdaInductiveConstructor{,} \AgdaBound{z*M} \AgdaInductiveConstructor{,} \AgdaBound{x*z[y/N]} \AgdaKeyword{with} \AgdaBound{y} \AgdaFunction{≟} \AgdaBound{z}\<%
\\
\>\AgdaFunction{lemma▹*} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{.\{}\AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)\}} \<[34]%
\>[34]\AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \<[47]%
\>[47]\AgdaBound{x*M[y/N]} \AgdaInductiveConstructor{▹β}\<%
\\
\>[2]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaSymbol{|} \AgdaSymbol{.}\AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{y*M} \AgdaInductiveConstructor{,} \AgdaBound{x*N} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{yes} \AgdaInductiveConstructor{refl} \AgdaSymbol{=} \AgdaInductiveConstructor{*·r} \AgdaBound{x*N}\<%
\\
\>\AgdaFunction{lemma▹*} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{.\{}\AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{y} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)\}} \<[34]%
\>[34]\AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \<[47]%
\>[47]\AgdaBound{x*M[y/N]} \AgdaInductiveConstructor{▹β}\<%
\\
\>[2]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaSymbol{|} \AgdaSymbol{.}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{x*M} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{*v} \<[23]%
\>[23]\AgdaSymbol{|} \AgdaInductiveConstructor{no} \AgdaBound{y≢z} \<[34]%
\>[34]\AgdaSymbol{=} \AgdaInductiveConstructor{*·l} \AgdaSymbol{(}\AgdaInductiveConstructor{*ƛ} \AgdaBound{x*M} \AgdaBound{y≢z}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{lemma→α*} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_*\_} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{dual} \AgdaFunction{\_→β\_}\AgdaSymbol{)} \AgdaComment{--\{M N : Λ\} → x * N → M →β N → x * M}\<%
\\
\>\AgdaFunction{lemma→α*} \AgdaBound{x*N} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaInductiveConstructor{ctxinj} \AgdaInductiveConstructor{▹β}\AgdaSymbol{)} \<[37]%
\>[37]\AgdaSymbol{=} \AgdaFunction{lemma▹*} \AgdaBound{x*N} \AgdaInductiveConstructor{▹β}\<%
\\
\>\AgdaFunction{lemma→α*} \AgdaSymbol{(}\AgdaInductiveConstructor{*·l} \AgdaBound{x*N}\AgdaSymbol{)} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·l} \AgdaBound{M→βN}\AgdaSymbol{)} \<[37]%
\>[37]\AgdaSymbol{=} \AgdaInductiveConstructor{*·l} \AgdaSymbol{(}\AgdaFunction{lemma→α*} \AgdaBound{x*N} \AgdaBound{M→βN}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma→α*} \AgdaSymbol{(}\AgdaInductiveConstructor{*·r} \AgdaBound{x*N'}\AgdaSymbol{)} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·l} \AgdaBound{M→βN}\AgdaSymbol{)} \<[37]%
\>[37]\AgdaSymbol{=} \AgdaInductiveConstructor{*·r} \AgdaBound{x*N'}\<%
\\
\>\AgdaFunction{lemma→α*} \AgdaSymbol{(}\AgdaInductiveConstructor{*·l} \AgdaBound{x*N}\AgdaSymbol{)} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·r} \AgdaBound{M→βN}\AgdaSymbol{)} \<[37]%
\>[37]\AgdaSymbol{=} \AgdaInductiveConstructor{*·l} \AgdaBound{x*N}\<%
\\
\>\AgdaFunction{lemma→α*} \AgdaSymbol{(}\AgdaInductiveConstructor{*·r} \AgdaBound{x*N'}\AgdaSymbol{)} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·r} \AgdaBound{M→βN}\AgdaSymbol{)} \<[37]%
\>[37]\AgdaSymbol{=} \AgdaInductiveConstructor{*·r} \AgdaSymbol{(}\AgdaFunction{lemma→α*} \AgdaBound{x*N'} \AgdaBound{M→βN}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma→α*} \AgdaSymbol{(}\AgdaInductiveConstructor{*ƛ} \AgdaBound{x*N} \AgdaBound{y≢x}\AgdaSymbol{)} \<[23]%
\>[23]\AgdaSymbol{(}\AgdaInductiveConstructor{ctxƛ} \AgdaBound{M→βN}\AgdaSymbol{)} \<[37]%
\>[37]\AgdaSymbol{=} \AgdaInductiveConstructor{*ƛ} \AgdaSymbol{(}\AgdaFunction{lemma→α*} \AgdaBound{x*N} \AgdaBound{M→βN}\AgdaSymbol{)} \AgdaBound{y≢x}\<%
\\
%
\\
\>\AgdaFunction{lemma→β\#} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_\#\_} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{\_→β\_}\AgdaSymbol{)} \AgdaComment{--\{M N : Λ\} → x \# M → M →β N → x \# N}\<%
\\
\>\AgdaFunction{lemma→β\#} \AgdaSymbol{=} \AgdaFunction{dual-*-\#} \AgdaFunction{lemma→α*}\<%
\\
%
\\
\>\AgdaFunction{lemma→α\#} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_\#\_} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{\_→α\_}\AgdaSymbol{)} \AgdaComment{-- \{M N : Λ\} → x \# M → M →α N → x \# N}\<%
\\
\>\AgdaFunction{lemma→α\#} \<[14]%
\>[14]\AgdaBound{x\#M} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{M→βN}\AgdaSymbol{)} \<[31]%
\>[31]\AgdaSymbol{=} \AgdaFunction{lemma→β\#} \AgdaBound{x\#M} \AgdaBound{M→βN}\<%
\\
\>\AgdaFunction{lemma→α\#} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \<[14]%
\>[14]\AgdaBound{x\#M} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaBound{M\textasciitildeN}\AgdaSymbol{)} \<[31]%
\>[31]\AgdaSymbol{=} \AgdaFunction{lemmaM∼N\#} \AgdaBound{M\textasciitildeN} \AgdaBound{x} \AgdaBound{x\#M}\<%
\\
%
\\
\>\AgdaFunction{lemma→α*\#} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaDatatype{\_\#\_} \AgdaBound{x}\AgdaSymbol{)} \AgdaFunction{preserved-by} \AgdaSymbol{(}\AgdaFunction{\_→α*\_}\AgdaSymbol{)} \AgdaComment{-- \{M N : Λ\} → x \# M → M →α* N → x \# N}\<%
\\
\>\AgdaFunction{lemma→α*\#} \AgdaBound{x\#M} \AgdaInductiveConstructor{refl} \<[35]%
\>[35]\AgdaSymbol{=} \AgdaBound{x\#M} \<[41]%
\>[41]\<%
\\
\>\AgdaFunction{lemma→α*\#} \AgdaBound{x\#M} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{M→αN}\AgdaSymbol{)} \<[35]%
\>[35]\AgdaSymbol{=} \AgdaFunction{lemma→α\#} \AgdaBound{x\#M} \AgdaBound{M→αN}\<%
\\
\>\AgdaFunction{lemma→α*\#} \AgdaBound{x\#M} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{M→α*P} \AgdaBound{P→α*N}\AgdaSymbol{)} \<[35]%
\>[35]\AgdaSymbol{=} \AgdaFunction{lemma→α*\#} \AgdaSymbol{(}\AgdaFunction{lemma→α*\#} \AgdaBound{x\#M} \AgdaBound{M→α*P}\AgdaSymbol{)} \AgdaBound{P→α*N}\<%
\\
%
\\
\>\AgdaFunction{lemmaƛ∼} \AgdaSymbol{:} \<[11]%
\>[11]\AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{y'} \AgdaSymbol{:} \AgdaFunction{V}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}}\<%
\\
\>[5]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{→} \AgdaBound{y} \AgdaFunction{\#⇂} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaBound{y'} \AgdaFunction{\#⇂} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[5]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{→} \AgdaInductiveConstructor{ƛ} \AgdaBound{y} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaBound{y}\AgdaSymbol{))} \AgdaDatatype{∼α} \AgdaInductiveConstructor{ƛ} \AgdaBound{y'} \<[48]%
\>[48]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaBound{y'}\AgdaSymbol{))} \<[72]%
\>[72]\<%
\\
\>\AgdaFunction{lemmaƛ∼} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaBound{y\#σ,ƛxM} \AgdaBound{y'\#σ,ƛxM}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaBound{y} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaBound{y}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∼⟨} \AgdaFunction{∼σ} \AgdaSymbol{(}\AgdaFunction{corollary4-2} \AgdaBound{y\#σ,ƛxM}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∼⟨} \AgdaFunction{corollary4-2} \AgdaBound{y'\#σ,ƛxM} \AgdaFunction{⟩} \<[32]%
\>[32]\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaBound{y'} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaBound{y'}\AgdaSymbol{))} \<[37]%
\>[37]\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{∎}\<%
\\
\>\<%
\end{code}

%<*alphabetaastersubstitutionsigma>
\begin{code}%
\>\AgdaFunction{lemma→α*Σ} \AgdaSymbol{:} \<[13]%
\>[13]\AgdaSymbol{\{}\AgdaBound{M} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaBound{σ'} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}} \<[31]%
\>[31]\<%
\\
\>[5]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{⇂} \AgdaBound{M}\<%
\\
\>[5]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{→α*} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ'}\<%
\end{code}
%</alphabetaastersubstitutionsigma>

\begin{code}%
\>\AgdaFunction{lemma→α*Σ} \AgdaSymbol{\{}\AgdaInductiveConstructor{v} \AgdaBound{x}\AgdaSymbol{\}} \<[19]%
\>[19]\AgdaBound{σ→α*σ'⇂M} \<[30]%
\>[30]\AgdaSymbol{=} \AgdaBound{σ→α*σ'⇂M} \AgdaBound{x} \AgdaInductiveConstructor{*v}\<%
\\
\>\AgdaFunction{lemma→α*Σ} \AgdaSymbol{\{}\AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \<[19]%
\>[19]\AgdaBound{σ→α*σ'⇂MN} \<[30]%
\>[30]\AgdaSymbol{=} \AgdaFunction{app-star} \<[42]%
\>[42]\AgdaSymbol{(}\AgdaFunction{lemma→α*Σ} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{(λ} \AgdaBound{z} \AgdaBound{z*M} \AgdaSymbol{→} \AgdaBound{σ→α*σ'⇂MN} \AgdaBound{z} \AgdaSymbol{(}\AgdaInductiveConstructor{*·l} \AgdaBound{z*M}\AgdaSymbol{)))}\<%
\\
\>[13]\AgdaIndent{42}{}\<[42]%
\>[42]\AgdaSymbol{(}\AgdaFunction{lemma→α*Σ} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{(λ} \AgdaBound{z} \AgdaBound{z*M} \AgdaSymbol{→} \AgdaBound{σ→α*σ'⇂MN} \AgdaBound{z} \AgdaSymbol{(}\AgdaInductiveConstructor{*·r} \AgdaBound{z*M}\AgdaSymbol{)))}\<%
\\
\>\AgdaFunction{lemma→α*Σ} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \<[19]%
\>[19]\AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ'}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{19}{}\<[19]%
\>[19]\AgdaBound{σ→α*σ'⇂ƛxM}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin→}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{=⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaFunction{y} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaFunction{abs-star} \AgdaSymbol{(}\AgdaFunction{lemma→α*Σ} \<[29]%
\>[29]\AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{)\}} \AgdaSymbol{\{}\AgdaBound{σ'} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{)\}}\<%
\\
\>[5]\AgdaIndent{29}{}\<[29]%
\>[29]\AgdaSymbol{(}\AgdaFunction{lemma-→α*ₛ⇂≺+} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaBound{σ→α*σ'⇂ƛxM} \AgdaInductiveConstructor{refl}\AgdaSymbol{))} \AgdaFunction{⟩}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaFunction{y} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ'} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaFunction{lemmaƛ∼} \AgdaFunction{y\#σ',ƛxM} \AgdaFunction{y'\#σ',ƛxM}\AgdaSymbol{))} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaFunction{y'} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ'} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y'}\AgdaSymbol{))} \<[38]%
\>[38]\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{=⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{σ'}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{▣}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y} \AgdaSymbol{=} \AgdaFunction{χ} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ,ƛxM} \AgdaSymbol{=} \AgdaFunction{χ-lemma2} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ',ƛxM} \AgdaSymbol{:} \AgdaFunction{y} \AgdaFunction{\#⇂} \AgdaSymbol{(}\AgdaBound{σ'} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ',ƛxM} \AgdaBound{z} \AgdaBound{z*ƛxM} \AgdaSymbol{=} \AgdaFunction{lemma→α*\#} \AgdaSymbol{(}\AgdaFunction{y\#σ,ƛxM} \AgdaBound{z} \AgdaBound{z*ƛxM}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{σ→α*σ'⇂ƛxM} \AgdaBound{z} \AgdaBound{z*ƛxM}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y'} \AgdaSymbol{=} \AgdaFunction{χ} \AgdaSymbol{(}\AgdaBound{σ'} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y'\#σ',ƛxM} \AgdaSymbol{=} \AgdaFunction{χ-lemma2} \AgdaBound{σ'} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\end{code}



-- %<*alphabetaastersubstitutionsigma>
-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemma→α*Σ :  \{M : Λ\}\{σ σ' : Σ\} }\<%
\\
\>\AgdaComment{--              → σ →α*ₛ σ'}\<%
\\
\>\AgdaComment{--              → M ∙ σ →α* M ∙ σ'}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}
-- %</alphabetaastersubstitutionsigma>

-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemma→α*Σ \{v x\}    σ→α*σ'  = σ→α*σ' x}\<%
\\
\>\AgdaComment{-- lemma→α*Σ \{M · N\}  σ→α*σ'  = app-star (lemma→α*Σ \{M\} σ→α*σ') (lemma→α*Σ \{N\} σ→α*σ')}\<%
\\
\>\AgdaComment{-- lemma→α*Σ \{ƛ x M\}  \{σ\} \{σ'\}}\<%
\\
\>\AgdaComment{--                    σ→α*σ'}\<%
\\
\>\AgdaComment{--   =  begin→}\<%
\\
\>\AgdaComment{--        (ƛ x M) ∙ σ}\<%
\\
\>\AgdaComment{--      =⟨ refl ⟩}\<%
\\
\>\AgdaComment{--        ƛ y   (M ∙ σ ≺+ ( x , v y))}\<%
\\
\>\AgdaComment{--      →⟨ abs-star (lemma→α*Σ \{M\} \{σ ≺+ (x , v y)\} \{σ' ≺+ (x , v y)\} (lemma-→α*ₛ≺+ \{x\} σ→α*σ' refl)) ⟩}\<%
\\
\>\AgdaComment{--        ƛ y   (M ∙ σ' ≺+ ( x , v y))}\<%
\\
\>\AgdaComment{--      →⟨ just (inj₂ (lemmaƛ∼ y\#σ',ƛxM y'\#σ',ƛxM)) ⟩}\<%
\\
\>\AgdaComment{--        ƛ y'  (M ∙ σ' ≺+ ( x , v y'))  }\<%
\\
\>\AgdaComment{--      =⟨ refl ⟩}\<%
\\
\>\AgdaComment{--        (ƛ x M) ∙ σ'}\<%
\\
\>\AgdaComment{--      ▣}\<%
\\
\>\AgdaComment{--   where}\<%
\\
\>\AgdaComment{--   y = χ (σ , ƛ x M)}\<%
\\
\>\AgdaComment{--   y\#σ,ƛxM = χ-lemma2 σ (ƛ x M)}\<%
\\
\>\AgdaComment{--   y\#σ',ƛxM : y \#⇂ (σ' , ƛ x M)}\<%
\\
\>\AgdaComment{--   y\#σ',ƛxM z z*ƛxM = lemma→α*\# (y\#σ,ƛxM z z*ƛxM) (σ→α*σ' z)}\<%
\\
\>\AgdaComment{--   y' = χ (σ' , ƛ x M)}\<%
\\
\>\AgdaComment{--   y'\#σ',ƛxM = χ-lemma2 σ' (ƛ x M)}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}

\begin{code}%
\>\AgdaFunction{lemma▹Λ} \AgdaSymbol{:} \<[11]%
\>[11]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}} \<[29]%
\>[29]\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{→} \AgdaBound{M} \AgdaDatatype{▹} \AgdaBound{M'}\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>\AgdaFunction{lemma▹Λ} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{.\{}\AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{)\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaInductiveConstructor{▹β}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin→}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{=⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaFunction{y} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{)))} \AgdaInductiveConstructor{·} \AgdaSymbol{(}\AgdaBound{N} \AgdaFunction{∙} \AgdaBound{σ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{ctxinj} \AgdaInductiveConstructor{▹β}\AgdaSymbol{))} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{))} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaFunction{y} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaFunction{∙} \AgdaBound{σ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaFunction{corollary1SubstLemma} \AgdaFunction{y\#σ,M}\AgdaSymbol{))} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N} \AgdaFunction{∙} \AgdaBound{σ}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{=⟨} \AgdaFunction{corollary1Prop7} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{))} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{▣}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y} \AgdaSymbol{=} \AgdaFunction{χ} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ,M} \AgdaSymbol{=} \AgdaFunction{χ-lemma2} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{lemma→βΛ} \AgdaSymbol{:} \<[12]%
\>[12]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}} \<[30]%
\>[30]\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→β} \AgdaBound{M'}\<%
\\
\>[2]\AgdaIndent{12}{}\<[12]%
\>[12]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>\AgdaFunction{lemma→βΛ} \<[10]%
\>[10]\AgdaSymbol{(}\AgdaInductiveConstructor{ctxinj} \AgdaBound{M▹M'}\AgdaSymbol{)} \<[25]%
\>[25]\AgdaSymbol{=} \AgdaFunction{lemma▹Λ} \AgdaBound{M▹M'}\<%
\\
\>\AgdaFunction{lemma→βΛ} \<[10]%
\>[10]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·l} \AgdaBound{M→βM'}\AgdaSymbol{)} \<[25]%
\>[25]\AgdaSymbol{=} \AgdaFunction{app-star} \AgdaSymbol{(}\AgdaFunction{lemma→βΛ} \AgdaBound{M→βM'}\AgdaSymbol{)} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma→βΛ} \<[10]%
\>[10]\AgdaSymbol{(}\AgdaInductiveConstructor{ctx·r} \AgdaBound{M→βM'}\AgdaSymbol{)} \<[25]%
\>[25]\AgdaSymbol{=} \AgdaFunction{app-star} \AgdaInductiveConstructor{refl} \AgdaSymbol{(}\AgdaFunction{lemma→βΛ} \AgdaBound{M→βM'}\AgdaSymbol{)}\<%
\\
\>\AgdaFunction{lemma→βΛ} \<[10]%
\>[10]\AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{ƛ} \AgdaSymbol{.}\AgdaBound{x} \AgdaBound{M'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{10}{}\<[10]%
\>[10]\AgdaSymbol{(}\AgdaInductiveConstructor{ctxƛ} \AgdaBound{M→βM'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin→}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{=⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaFunction{y} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M} \<[18]%
\>[18]\AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaFunction{abs-star} \AgdaSymbol{(}\AgdaFunction{lemma→βΛ} \AgdaBound{M→βM'}\AgdaSymbol{)} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaFunction{y} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M'} \<[19]%
\>[19]\AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaSymbol{(}\AgdaFunction{lemmaƛ∼} \AgdaFunction{y\#σ,ƛxM'} \AgdaFunction{y'\#σ,ƛxM'}\AgdaSymbol{))} \AgdaFunction{⟩} \<[62]%
\>[62]\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaInductiveConstructor{ƛ} \AgdaFunction{y'} \<[13]%
\>[13]\AgdaSymbol{(}\AgdaBound{M'} \<[18]%
\>[18]\AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{≺+} \AgdaSymbol{(} \AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{v} \AgdaFunction{y'}\AgdaSymbol{))} \<[39]%
\>[39]\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{=⟨} \AgdaInductiveConstructor{refl} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M'}\AgdaSymbol{)} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{▣}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y} \AgdaSymbol{=} \AgdaFunction{χ} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ,ƛxM} \AgdaSymbol{=} \AgdaFunction{χ-lemma2} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y'} \AgdaSymbol{=} \AgdaFunction{χ} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y'\#σ,ƛxM'} \AgdaSymbol{:} \AgdaFunction{y'} \AgdaFunction{\#⇂} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y'\#σ,ƛxM'} \AgdaSymbol{=} \AgdaFunction{χ-lemma2} \AgdaBound{σ} \AgdaSymbol{(}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ,ƛxM'} \AgdaSymbol{:} \AgdaFunction{y} \AgdaFunction{\#⇂} \AgdaSymbol{(}\AgdaBound{σ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaFunction{y\#σ,ƛxM'} \AgdaBound{z} \AgdaBound{z*λxM'} \AgdaSymbol{=} \AgdaFunction{y\#σ,ƛxM} \AgdaBound{z} \AgdaSymbol{(}\AgdaFunction{lemma→α*} \AgdaBound{z*λxM'} \AgdaSymbol{(}\AgdaInductiveConstructor{ctxƛ} \AgdaBound{M→βM'}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\<%
\end{code}

%<*betaalphasubstitutionterm>
\begin{code}%
\>\AgdaFunction{lemma→α*Λ} \AgdaSymbol{:} \<[13]%
\>[13]\AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}} \<[31]%
\>[31]\<%
\\
\>[2]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{M'}\<%
\\
\>[2]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaFunction{∙} \AgdaBound{σ}\<%
\end{code}
%</betaalphasubstitutionterm>

\begin{code}%
\>\AgdaFunction{lemma→α*Λ} \AgdaInductiveConstructor{refl}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma→α*Λ} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaBound{M→βM'}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaFunction{lemma→βΛ} \AgdaBound{M→βM'}\<%
\\
\>\AgdaFunction{lemma→α*Λ} \AgdaSymbol{\{}\AgdaArgument{σ} \AgdaSymbol{=} \AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₂} \AgdaBound{M∼M'}\AgdaSymbol{))}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaKeyword{rewrite} \AgdaFunction{lemmaM∼M'→Mσ≡M'σ} \AgdaSymbol{\{}\AgdaArgument{σ} \AgdaSymbol{=} \AgdaBound{σ}\AgdaSymbol{\}} \AgdaBound{M∼M'} \<[40]%
\>[40]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{refl}\<%
\\
\>\AgdaFunction{lemma→α*Λ} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{M→α*N} \AgdaBound{N→α*M'}\AgdaSymbol{)}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \AgdaInductiveConstructor{trans} \AgdaSymbol{(}\AgdaFunction{lemma→α*Λ} \AgdaBound{M→α*N}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaFunction{lemma→α*Λ} \AgdaBound{N→α*M'}\AgdaSymbol{)}\<%
\end{code}

-- 
-- \begin{code}%
\>\<%
\\
\>\AgdaComment{-- lemma→α*subst  : \{M M' : Λ\}\{σ σ' : Σ\} }\<%
\\
\>\AgdaComment{--         → M →α* M' → σ →α*ₛ σ'}\<%
\\
\>\AgdaComment{--         → M ∙ σ →α* M' ∙ σ'}\<%
\\
\>\AgdaComment{-- lemma→α*subst \{M\} \{M'\} \{σ\} \{σ'\} M→α*M' σ→α*σ'}\<%
\\
\>\AgdaComment{--   =  begin→}\<%
\\
\>\AgdaComment{--        M ∙ σ}\<%
\\
\>\AgdaComment{--      →⟨ lemma→α*Λ M→α*M' ⟩}\<%
\\
\>\AgdaComment{--        M' ∙ σ}\<%
\\
\>\AgdaComment{--      →⟨ lemma→α*Σ \{M'\} σ→α*σ' ⟩}\<%
\\
\>\AgdaComment{--        M' ∙ σ'}\<%
\\
\>\AgdaComment{--      ▣}\<%
\\
\>\AgdaComment{-- }\<%
\end{code}
-- %</betaastersubstitution>

%<*betaastersubstitution>
\begin{code}%
\>\AgdaFunction{lemma→α*subst} \<[15]%
\>[15]\AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{M} \AgdaBound{M'} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}\{}\AgdaBound{σ} \AgdaBound{σ'} \AgdaSymbol{:} \AgdaFunction{Σ}\AgdaSymbol{\}} \<[38]%
\>[38]\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{σ} \AgdaFunction{→α*ₛ} \AgdaBound{σ'} \AgdaFunction{⇂} \AgdaBound{M}\<%
\\
\>[2]\AgdaIndent{8}{}\<[8]%
\>[8]\AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaFunction{∙} \AgdaBound{σ'}\<%
\\
\>\AgdaFunction{lemma→α*subst} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{σ'}\AgdaSymbol{\}} \AgdaBound{M→α*M'} \AgdaBound{σ→α*σ'⇂M}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{=} \<[5]%
\>[5]\AgdaFunction{begin→}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaFunction{lemma→α*Σ} \AgdaBound{σ→α*σ'⇂M} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaBound{M} \AgdaFunction{∙} \AgdaBound{σ'}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{→⟨} \AgdaFunction{lemma→α*Λ} \AgdaBound{M→α*M'} \AgdaFunction{⟩}\<%
\\
\>[5]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaBound{M'} \AgdaFunction{∙} \AgdaBound{σ'}\<%
\\
\>[0]\AgdaIndent{5}{}\<[5]%
\>[5]\AgdaFunction{▣}\<%
\end{code}
%</betaastersubstitution>

Subject Reduction

\begin{code}%
\>\AgdaFunction{lemma⊢→α*} \AgdaSymbol{:} \<[13]%
\>[13]\AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Cxt}\AgdaSymbol{\}\{}\AgdaBound{α} \AgdaSymbol{:} \AgdaDatatype{Type}\AgdaSymbol{\}\{}\AgdaBound{M} \AgdaBound{N} \AgdaSymbol{:} \AgdaDatatype{Λ}\AgdaSymbol{\}} \<[42]%
\>[42]\<%
\\
\>[5]\AgdaIndent{13}{}\<[13]%
\>[13]\AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{M} \AgdaDatatype{∶} \AgdaBound{α} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{N} \AgdaSymbol{→} \AgdaBound{Γ} \AgdaDatatype{⊢} \AgdaBound{N} \AgdaDatatype{∶} \AgdaBound{α}\<%
\\
\>\AgdaFunction{lemma⊢→α*} \AgdaBound{Γ⊢M:α} \AgdaInductiveConstructor{refl} \<[38]%
\>[38]\AgdaSymbol{=} \AgdaBound{Γ⊢M:α}\<%
\\
\>\AgdaFunction{lemma⊢→α*} \AgdaBound{Γ⊢M:α} \AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaBound{M→βN}\AgdaSymbol{)} \<[38]%
\>[38]\AgdaSymbol{=} \AgdaFunction{lemma⊢→α} \AgdaBound{Γ⊢M:α} \AgdaBound{M→βN}\<%
\\
\>\AgdaFunction{lemma⊢→α*} \AgdaBound{Γ⊢M:α} \AgdaSymbol{(}\AgdaInductiveConstructor{trans} \AgdaBound{M→α*N} \AgdaBound{N→α*P}\AgdaSymbol{)} \<[38]%
\>[38]\AgdaSymbol{=} \AgdaFunction{lemma⊢→α*} \AgdaSymbol{(}\AgdaFunction{lemma⊢→α*} \AgdaBound{Γ⊢M:α} \AgdaBound{M→α*N}\AgdaSymbol{)} \AgdaBound{N→α*P}\<%
\\
%
\\
\>\AgdaFunction{→β-rdx} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{M} \AgdaBound{N} \AgdaBound{M'} \AgdaBound{N'}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{N'} \AgdaSymbol{→} \AgdaSymbol{(}\AgdaBound{M} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N}\AgdaSymbol{))} \AgdaFunction{→α*} \AgdaSymbol{(}\AgdaBound{M'} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N'}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{→β-rdx} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaBound{M→α*N'} \AgdaBound{N→α*N'} \AgdaSymbol{=} \AgdaFunction{lemma→α*subst} \AgdaBound{M→α*N'} \AgdaSymbol{(}\AgdaFunction{lemma-→α*ₛ→→α*ₛ⇂} \AgdaBound{M} \AgdaSymbol{(}\AgdaFunction{lemma-→α*ₛ≺+} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{ι}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaFunction{ι}\AgdaSymbol{\}} \AgdaFunction{lemma-→α*ₛι} \AgdaBound{N→α*N'}\AgdaSymbol{))}\<%
\\
%
\\
\>\AgdaFunction{→α*-rdx} \AgdaSymbol{:} \AgdaSymbol{∀} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{M} \AgdaBound{N} \AgdaBound{M'} \AgdaBound{N'}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaBound{M} \AgdaFunction{→α*} \AgdaBound{M'} \AgdaSymbol{→} \AgdaBound{N} \AgdaFunction{→α*} \AgdaBound{N'} \AgdaSymbol{→} \AgdaSymbol{((}\AgdaInductiveConstructor{ƛ} \AgdaBound{x} \AgdaBound{M}\AgdaSymbol{)} \AgdaInductiveConstructor{·} \AgdaBound{N}\AgdaSymbol{)} \AgdaFunction{→α*} \AgdaSymbol{(}\AgdaBound{M'} \AgdaFunction{∙} \AgdaFunction{ι} \AgdaFunction{≺+} \AgdaSymbol{(}\AgdaBound{x} \AgdaInductiveConstructor{,} \AgdaBound{N'}\AgdaSymbol{))}\<%
\\
\>\AgdaFunction{→α*-rdx} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N'}\AgdaSymbol{\}} \AgdaBound{M→M'} \AgdaBound{N→N'} \AgdaSymbol{=} \AgdaInductiveConstructor{trans} \<[50]%
\>[50]\AgdaSymbol{(}\AgdaInductiveConstructor{just} \AgdaSymbol{(}\AgdaInductiveConstructor{inj₁} \AgdaSymbol{(}\AgdaInductiveConstructor{ctxinj} \AgdaInductiveConstructor{▹β}\AgdaSymbol{)))}\<%
\\
\>[13]\AgdaIndent{50}{}\<[50]%
\>[50]\AgdaSymbol{(}\AgdaFunction{→β-rdx} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{M'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{N'}\AgdaSymbol{\}} \AgdaBound{M→M'} \AgdaBound{N→N'}\AgdaSymbol{)}\<%
\end{code}







